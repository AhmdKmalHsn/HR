@{
    /**/

    Layout = "~/Views/Shared/_Layout.cshtml";
}

@*/*Advanced / Payment /Create New Vacancy and Approved OverTim*/*@

<style>
    .ui-dialog-titlebar-close {
        visibility: hidden;
    }
</style>
@using (Html.BeginForm("Create", "VacationStatus", FormMethod.Post))
{

    <div class="card">
        <div class="container">
            <div class="card-header row" style="  padding-left: 0;padding-right: 0;">
                <div class="col-md-6" style="padding-left:0">
                    <h5 class="text-capitalize btn">Vacation Status</h5>
                </div>
            </div>
        </div>
        <!--start advansed-->
        <div class="container mt-5">
            <div class="row ">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label for="colFormLabelLg" class="col-sm-4 col-form-label col-form-label-sm">Date From  </label>
                                <div class="col-sm-8">
                                    <input placeholder="Date From" class="form-control form-control-sm text-box single-line change" data-val="true" data-val-date="The field Absence Date From must be a date." data-val-required="The Absence Date From field is required." id="DateFrom" name="DateFrom" type="date" value="">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label for="colFormLabelLg" class="col-sm-4 col-form-label col-form-label-sm">To</label>
                                <div class="col-sm-8">
                                    <input type="date" name="DateTo" id="DateTo" class="form-control form-control-sm change">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label for="Job Title" class="col-sm-4 col-form-label-sm">Employee File Number</label>
                                <div class="col-sm-8">
                                    <select class="custom-select form-control-sm w-100 change" data-val="true" data-val-number="The field JobTitleId must be a number." id="FileNumber" name="FileNumber">
                                        <option value="0">Select File Number</option>
                                        @foreach (var item in ViewBag.Employees)
                                        {
                                            <option value="@item.Id">@item.FileNumber</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="Job Title" class="col-sm-4 col-form-label-sm">Type</label>
                                <div class="col-sm-8">
                                    <select class="custom-select form-control-sm w-100 change" data-val="true" data-val-number="The field JobTitleId must be a number." id="Type" name="Type">
                                        <option value="0">Select Type</option>
                                        @foreach (var item in ViewBag.Types)
                                        {
                                            <option value="@item.Id">@item.Value</option>
                                        }
                                    </select>

                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="Job Title" class="col-sm-4 col-form-label-sm">Class</label>
                                <div class="col-sm-8">
                                    <select class="custom-select form-control-sm w-100 change" data-val="true" data-val-number="The field JobTitleId must be a number." id="Class" name="Class">
                                        <option value="0">Select Class</option>
                                        @foreach (var item in ViewBag.Class)
                                        {
                                            <option value="@item.Id">@item.Name</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="Job Title" class="col-sm-4 col-form-label-sm">Personal Area</label>
                                <div class="col-sm-8">
                                    <input class="form-control-sm w-100" onkeyup="GetList()" name="PersonalArea" id="PersonalArea" placeholder="Enter Personal Area" />
                                </div>
                            </div>




                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label for="Job Title" class="col-sm-4 col-form-label-sm">Personal Sub Area</label>
                                <div class="col-sm-8">
                                    <input class="form-control-sm w-100" name="PersonalSubArea" onkeyup="GetList()" id="PersonalSubArea" placeholder="Enter Personal Sub Area" />
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="Job Title" class="col-sm-4 col-form-label-sm">Sub Division</label>
                                <div class="col-sm-8">
                                    <input class="form-control-sm w-100" name="SubDivision" id="SubDivision" onkeyup="GetList()" placeholder="Enter Sub Division" />
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="Job Title" class="col-sm-4 col-form-label-sm">Division</label>
                                <div class="col-sm-8">
                                    <input class="form-control-sm w-100" name="Division" id="Division" onkeyup="GetList()" placeholder="Enter Division" />
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="Job Title" class="col-sm-4 col-form-label-sm">Department</label>
                                <div class="col-sm-8">
                                    <select class="custom-select form-control-sm w-100 change" data-val="true" data-val-number="The field JobTitleId must be a number." id="Department" name="Department">
                                        <option value="0">Select Department</option>
                                        @foreach (var item in ViewBag.Department)
                                        {
                                            <option value="@item.Id">@item.Name</option>
                                        }
                                    </select>

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 ">
                    <div class="">
                        <div class="ff" style="overflow: auto; height: 500px;">
                            <table id="demo" class="table table-striped table-bordered table-sm tbody" cellspacing="0" width="100%">
                                <thead>

                                    <tr>
                                        <th class="text-center" colspan="11" style="background:#F2F2F2;">
                                            File No.
                                            <input class="form-control" id="FileNo" type="text" placeholder="Search..">
                                        </th>
                                        <th class="text-center" colspan="10">
                                            Employee Name
                                            <input class="form-control" id="EmployeeName" type="text" placeholder="Search..">
                                        </th>

                                        <th class="text-center" colspan="6" style="background:#F2F2F2">
                                            معدل الاجازه الشهري
                                            <input class="form-control" id="prec" type="text" placeholder="Search..">
                                        </th>
                                        <th class="text-center" colspan="6">
                                            مجموع الاجازات في فتره محدده
                                            <input class="form-control" id="sum" type="text" placeholder="Search..">
                                        </th>
                                        <th class="text-center" colspan="6">
                                            الرصيد المتبقي حتي تاريخه
                                            <input class="form-control" id="dat" type="text" placeholder="Search..">
                                        </th>

                                        <th class="text-center" colspan="6" style="background:#F2F2F2">الاجازات المرحلة</th>
                                    </tr>

                                </thead>
                                <tbody class="text-center"></tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>



        <!-- Row end -->
        <!-- Row start -->
        @*<div class="container mt-5">
            <div class="row">
                <div class="col-md-6">
                    @*<button type="submit" class="btn btn-primary ">Add</button>*@
        @*
                    <label class="btn btn-primary" onclick="add()">Add</label>
                </div>

            </div>
        </div>*@

        <!-- Row end -->
    </div>

}

<script type="text/javascript" src="~/bower_components/jquery/js/jquery.min.js"></script>
<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>

<script>
    var t = document.title;
    document.title = t + " - " + "QweqOverTime";
    $(document).ready(function () {
        let z = $('#demo').width();
        //$('.ff').scrollLeft(z);
        $('.ff').scrollLeft(z + z + z + z + z + z + z + z + z + z + z)
////

        $("#FileNo").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
        $("#EmployeeName").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });

        $("#prec").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
        $("#sum").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
 $("#dat").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });


    })

    $('.change').change(function () {
        GetList();
    })

    function GetList() {
        if ($('#DateFrom').val() != null && $('#DateTo').val() != null && $('#DateFrom').val() != "" && $('#DateTo').val() != "") {
            $.ajax({
                type: 'POST',
                url: 'GetData',
                dataType: 'json',
                data: {
                    DateFrom: $('#DateFrom').val(),
                    DateTo: $('#DateTo').val(),
                    Type: $('#Type').val(),
                    Class: $('#Class').val(),
                    FileNumber: $('#FileNumber').val(),
                    PersonalArea: $('#PersonalArea').val(),
                    PersonalSubArea: $('#PersonalSubArea').val(),
                    Division: $('#Division').val(),
                    SubDivision: $('#SubDivision').val(),
                    Department: $('#Department').val()
                },
                success: function (mems) {
                    debugger;
                    $('#demo').empty();
                    $('#demo').append('<tr><th class= "text-center" colspan = "11" style = "background:#F2F2F2;">File No.<input class= "form-control" id = "FileNo" type = "text" placeholder = "Search.."></th><th class="text-center" colspan="10">Employee Name<input class="form-control" id="EmployeeName" type="text" placeholder="Search.."></th><th class="text-center" colspan="6" style="background:#F2F2F2">معدل الاجازه الشهري<input class="form-control" id="prec" type="text" placeholder="Search.."></th><th class="text-center" colspan="6">مجموع الاجازات في فتره محدده<input class="form-control" id="sum" type="text" placeholder="Search.."></th><th class="text-center" colspan="6">الرصيد المتبقي حتي تاريخه<input class="form-control" id="dat" type="text" placeholder="Search.."></th><th class="text-center" colspan="6" style="background:#F2F2F2">الاجازات المرحلة</th></tr>');
                    for (var i = 0; i < mems.length; i++) {
                        $('#demo').append("<tr><td colspan = '11'>" + mems[i].FileNo + "</td><td colspan = '10'>" + mems[i].EmployeeName + "</td><td colspan = '6'>" + mems[i].AverageMonthlyVacation + "</td><td colspan = '6'>" + mems[i].TotalVacations + "</td><td colspan = '6'>" + mems[i].RemainingVacations + "</td><td colspan = '6'>" + mems[i].StageVacations + "</td></tr>");
                    }
                },
                error: function (ex) {
                    alert("error in data");
                }
            });
        }
    }

    function add() {
        let c = $(".checks");
        let n = $(".numbers");
        var checks = new Array();
        var numbers = new Array();
        for (var i = 0; i < n.length; i++) {
            checks[i] = c[i].checked;
            numbers[i] = n[i].value;
        }

        $.ajax({
            type: 'POST',
            url: 'Create',
            dataType: 'json',
            data: {
                checks: checks,
                numbers: numbers
            },
            success: function (mems) {
                debugger;
                if (mems == "All data saved" || mems == "some over time is existing") {
                    alert(mems);
                    window.location.href = "/AdditionApproval/Index/";
                }
                else
                    alert(mems)
            },
            error: function (ex) {
                alert("error in data");
            }
        });
    }
</script>
<script>
    $(function () {
        $('.aa').click(function () {
            var tr = $('.k ').find('tr').length;
            console.log(tr)

            if (tr >= 6) {

                $('.table-responsive').css('overflow-y', "scroll");
                $('.table-responsive').css('height', "340px")
            }
            else {
                $('.table-responsive').css('overflow', "hidden");

            }
        })
    })
</script>